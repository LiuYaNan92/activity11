<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=750,target-densityDpi=device-dpi, user-scalable=no">
    <title>首页</title>
    <link rel="stylesheet" href="/WinsMS/application/webapi/view/double_eleven/css/common.css">
    <link rel="stylesheet" href="/WinsMS/application/webapi/view/double_eleven/css/style.css">
    <link rel="stylesheet" href="/WinsMS/application/webapi/view/double_eleven/css/animate.css">
    <script src="/WinsMS/application/webapi/view/double_eleven/js/jquery-2.0.0.min.js"></script>
    <script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
    <script src="/WinsMS/application/webapi/view/double_eleven/js/vue.js"></script>
    <script src="/WinsMS/application/webapi/view/double_eleven/js/preloadjs.min.js"></script>
    <script src="/WinsMS/application/webapi/view/double_eleven/js/vconsole.min.js"></script>

</head>
<body>
<div id="app">
    <div class="music rotateFun" :style="{'animation-play-state':(moveFlag?'running':'paused')}"></div>
    <audio id="daoJiShi" src="https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/daojishi.mp3" controls="controls" alt="倒计时五秒" style="display: none;"></audio>
    <audio id="bg" src="https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/bg.mp3" controls="controls" loop="true" alt="背景音效" style="display: none;"></audio>
    <audio id="click" src="https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/dianji.mp3" controls="controls" alt="点击" style="display: none;"></audio>
    <audio id="error" src="https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/error.mp3" controls="controls" alt="很遗憾" style="display: none;"></audio>
    <audio id="right" src="https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/right.mp3" controls="controls" alt="恭喜您" style="display: none;"></audio>
    <audio id="hb1" src="https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/hb1.mp3" controls="controls" alt="海报等级一" style="display: none;"></audio>
    <audio id="hb2" src="https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/hb2.mp3" controls="controls" alt="海报等级二" style="display: none;"></audio>
    <audio id="hb3" src="https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/hb3.mp3" controls="controls" alt="海报等级三" style="display: none;"></audio>
    <audio id="hb4" src="https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/hb4.mp3" controls="controls" alt="海报等级四" style="display: none;"></audio>
    <div class="left-box"></div>
    <div class="right-box"></div>
    <div class="home" v-if="homeFlag">
        <div class="height"></div>
        <div class="h-text"></div>
        <div class="h-btn1 animated zoomSwitch" a="答题说明" @click="explainClick" ></div>
        <div class="h-btn2 animated zoomSwitch" a="进入考场" @click="startClick"></div>
    </div>
    <div class="page1" v-if="page1Flag">
        <div class="bg" a="绿色背景"></div>
        <div a="文字" class="text" :class="{'fadeInUp':anClass2}" v-if="anClass1" @click="textClick"></div>
        <div class="skip" a="跳过" @click="skipClick" v-if="skipFlag"></div>
        <div class="bg1" a="祥云海浪"></div>
        <div class="bg2" a="祥云海浪"></div>
    </div>
    <div class="question-warp" v-if="questionBox">
        <div class="question-box" a="问题">
            <div class="q-top" a="问题头部"></div>
            <div class="alarm-clock animated" :class="{'tada':timeFlag}" a="闹钟" v-if="alarmClock">
                <span class="num1" v-if="time==0"></span>
                <span class="num2" v-if="time==1"></span>
                <span class="num3" v-if="time==2"></span>
                <span class="num4" v-if="time==3"></span>
                <span class="num5" v-if="time==4"></span>
                <!--                <span class="num6" v-if="time==5"></span>-->
                <!--                <span class="num7" v-if="time==6"></span>-->
                <!--                <span class="num8" v-if="time==7"></span>-->
                <!--                <span class="num9" v-if="time==8"></span>-->
                <!--                <span class="num10" v-if="time==9"></span>-->
            </div>
            <div class="question-box1 animated" :class="{'rotateOutUpLeft':quesFlag1}" v-if="question1">
                <div class="box" :style="{'z-index':(quesFlag1?1:11)}">
                    <div class="question1" a="第一题内容"></div>
                    <div class="q1-option1" a="选项一" @click="question1A"></div>
                    <div class="q1-option2" a="选项二" @click="question1B"></div>
                    <div class="q1-option3" a="选项三" @click="question1C"></div>
                </div>
            </div>
            <div class="question-box2 animated" :class="{'rotateOutUpRight':quesFlag2}" v-if="question2">
                <div class="box" :style="{'z-index':(quesFlag2?1:11)}">
                    <div class="question2" a="第二题内容"></div>
                    <div class="q2-option1" a="选项一" @click="question2A"></div>
                    <div class="q2-option2" a="选项二" @click="question2B"></div>
                    <div class="q2-option3" a="选项三" @click="question2C"></div>
                </div>
            </div>
            <div class="question-box3 animated" :class="{'rotateOutUpLeft':quesFlag3}" v-if="question3">
                <div class="box" :style="{'z-index':(quesFlag3?1:11)}">
                    <div class="question3" a="第三题内容"></div>
                    <div class="q3-option1" a="选项一" @click="question3A"></div>
                    <div class="q3-option2" a="选项二" @click="question3B"></div>
                    <div class="q3-option3" a="选项三" @click="question3C"></div>
                </div>
            </div>
            <div class="question-box4 animated" :class="{'rotateOutUpRight':quesFlag4}" v-if="question4">
                <div class="box" :style="{'z-index':(quesFlag4?1:11)}">
                    <div class="question4" a="第四题内容"></div>
                    <div class="q4-option1" a="选项一" @click="question4A"></div>
                    <div class="q4-option2" a="选项二" @click="question4B"></div>
                    <div class="q4-option3" a="选项三" @click="question4C"></div>
                </div>
            </div>
            <div class="question-box5 animated" v-if="question5">
                <div class="box">
                    <div class="question5" a="第五题内容"></div>
                    <div class="q5-option1" a="选项一" @click="question5A"></div>
                    <div class="q5-option2" a="选项二" @click="question5B"></div>
                    <div class="q5-option3" a="选项三" @click="question5C"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="info-box" v-if="infoFlag">
        <div class="info animated" :class="{'fadeIn':infoFlag}"  a="填写姓名弹窗">
            <div class="info-bg"></div>
            <div class="head-img">
                <img :src="headImgUrl" alt="">
            </div>
            <div class="name" a="姓名">
                <input type="text" maxlength="4" value="" v-model="oName">
            </div>
            <div class="btn" a="开始考试" @click="startExamination"></div>
        </div>
    </div>
    <div class="last" v-if="lastFlag">
        <img class="bg" src="/WinsMS/application/webapi/view/double_eleven/images/l_bg1.png" style="display: none;" alt="">
        <img class="bg" src="/WinsMS/application/webapi/view/double_eleven/images/l_bg2.png" style="display: none;" alt="">
        <img class="bg" src="/WinsMS/application/webapi/view/double_eleven/images/l_bg3.png" style="display: none;" alt="">
        <img class="bg" src="/WinsMS/application/webapi/view/double_eleven/images/l_bg4.png" style="display: none;" alt="">
        <img class="bg" src="/WinsMS/application/webapi/view/double_eleven/images/lv1.png" style="display: none;" alt="">
        <img class="bg" src="/WinsMS/application/webapi/view/double_eleven/images/lv2.png" style="display: none;" alt="">
        <img class="bg" src="/WinsMS/application/webapi/view/double_eleven/images/lv3.png" style="display: none;" alt="">
        <img class="bg" src="/WinsMS/application/webapi/view/double_eleven/images/lv4.png" style="display: none;" alt="">
        <canvas id="myCanvas"></canvas>
        <div id='photoPic' class="photoPic">
            <div class="imgbox">
                <img src="" alt="" />
            </div>
        </div>
    </div>
    <div class="maskBox1 animated" v-if="maskFlag1" :class="{'fadeIn':maskFlag1}">
        <div class="m-bg">
            <div class="closeBtn" v-if="oIndex==5" @click="createPoster"></div>
            <div class="closeBtn" v-else @click="closeClick"></div>
            <img class="m-img1" v-if="bestFlag" src="/WinsMS/application/webapi/view/double_eleven/images/best.png" alt="">
            <img class="m-img2" v-if="noBestFlag" src="/WinsMS/application/webapi/view/double_eleven/images/no_best.png" alt="">
            <div class="m1-text1" v-if="mask1Text1"></div>
            <div class="m1-text2" v-if="mask1Text2"></div>
            <div class="m1-text3" v-if="mask1Text3"></div>
            <div class="m2-text1" v-if="mask2Text1"></div>
            <div class="m2-text2" v-if="mask2Text2"></div>
            <div class="m2-text3" v-if="mask2Text3"></div>
            <div class="m3-text1" v-if="mask3Text1"></div>
            <div class="m3-text2" v-if="mask3Text2"></div>
            <div class="m3-text3" v-if="mask3Text3"></div>
            <div class="m4-text1" v-if="mask4Text1"></div>
            <div class="m4-text2" v-if="mask4Text2"></div>
            <div class="m4-text3" v-if="mask4Text3"></div>
            <div class="m5-text1" v-if="mask5Text1"></div>
            <div class="m5-text2" v-if="mask5Text2"></div>
            <div class="m5-text3" v-if="mask5Text3"></div>
            <div class="btn1" v-if="quesFlag5==false" @click="closeClick" a="确定按钮"></div>
            <div class="btn2" v-if="quesFlag5" @click="createPoster" a="生成海报"></div>
        </div>
    </div>
    <!--    超时弹窗-->
    <div class="maskBox2" v-if="maskFlag2" :class="{'fadeIn':maskFlag2}">
        <div class="m-bg">
            <div class="closeBtn" v-if="oIndex==4" @click="createPoster"></div>
            <div class="closeBtn" v-else @click="nextQuestion"></div>
            <img class="m-img1" v-if="bestFlag" src="/WinsMS/application/webapi/view/double_eleven/images/best.png" alt="">
            <img class="m-img2" v-if="noBestFlag" src="/WinsMS/application/webapi/view/double_eleven/images/no_best.png" alt="">
            <div class="m-text" v-if="mask2Text"></div>
            <div class="m1-text2" v-if="mask1Text2"></div>
            <div class="optimal-text1" v-if="mask1Text2"></div>
            <div class="m2-text1" v-if="mask2Text1"></div>
            <div class="optimal-text2" v-if="mask2Text1"></div>
            <div class="m3-text2" v-if="mask3Text2"></div>
            <div class="optimal-text3" v-if="mask3Text2"></div>
            <div class="m4-text1" v-if="mask4Text1"></div>
            <div class="optimal-text4" v-if="mask4Text1"></div>
            <div class="m5-text3" v-if="mask5Text3"></div>
            <div class="optimal-text5" v-if="mask5Text3"></div>
            <div class="btn2" @click="nextQuestion" a="确定按钮" v-if="maskBtn1"></div>
            <div class="btn3" @click="bestAnswer" a="查看最优答案"  v-if="maskBtn2"></div>
            <div class="btn4" @click="nextQuestion" a="继续下一题" v-if="maskBtn3"></div>
            <div class="btn5" @click="createPoster" a="生成海报" v-if="maskBtn4"></div>
        </div>
    </div>
    <div class="maskBox3" v-if="maskFlag3">
        <div class="m3-bg">
            <div class="closeBtn3" @click="closeMaskClick"></div>
            <div class="m3-btn" a="确定按钮" @click="closeMaskClick"></div>
        </div>
    </div>

    <div class="tipsBox animated" :class="{'fadeIn':tipsFlag}" v-if="tipsFlag">
        <div class="tipsText">请填写姓名</div>
    </div>
    <div class="loading-wrap  center loading">
        <img src="/WinsMS/application/webapi/view/double_eleven/images/loading1.gif" alt="">
        <span class="percent" style="position: absolute;margin-top:168px;font-size:24px;color:#fff;">0 %</span>
    </div>
</div>
<script>
    var vConsole=new VConsole();
</script>
<script>
    $(function () {
        //bounceInUp
        //题消失动画 rotateOutUpLeft
        let appId="{$appId}";
        let timestamp="{$timestamp}";
        let nonceStr="{$nonceStr}";
        let signature="{$signature}";
        let openid="{$openid}";
        let nickname="{$nickname}";
        let headImgUrl="{$headimgurl}";
        let actId="{$actid}";
        //手机终端判断
        let isReset = true;
        let u = navigator.userAgent;
        let isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1; //android终端
        let isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
        let daoJiShi=document.getElementById('daoJiShi');//倒计时音效
        let bgMusic=document.getElementById('bg');//倒计时音效
        let clickMusic=document.getElementById('click');//点击音效
        let errorMusic=document.getElementById('error');//很遗憾音效
        let rightMusic=document.getElementById('right');//恭喜您音效
        let hb1Music=document.getElementById('hb1');//海报等级一音效
        let hb2Music=document.getElementById('hb2');//海报等级一音效
        let hb3Music=document.getElementById('hb3');//海报等级一音效
        let hb4Music=document.getElementById('hb4');//海报等级一音效
        localStorage.setItem('openid',openid);
        localStorage.setItem('actid',actId);
        console.log('appId',appId);
        console.log('timestamp',timestamp);
        console.log('nonceStr',nonceStr);
        console.log('signature',signature);
        console.log('openid',openid);
        console.log('nickname',nickname);
        console.log('headImgUrl',headImgUrl);
        console.log('actId',actId);
        //禁止苹果的上下滑动事件
        document.body.addEventListener('touchmove', function (e) {
            e.preventDefault(); //阻止默认的处理方式(阻止下拉滑动的效果)
        }, {passive: false}); //passive 参数不能省略，用来兼容ios和android
        //音效加载
        daoJiShi.load();//倒计时音效
        bgMusic.load();//背景音效
        clickMusic.load();//点击音效
        errorMusic.load();//很遗憾音效
        rightMusic.load();//恭喜您音效
        hb1Music.load();//海报等级一音效
        hb2Music.load();//海报等级二音效
        hb3Music.load();//海报等级三音效
        hb4Music.load();//海报等级四音效
        //音乐图标点击事件rotateFun
        let msFlag=true;
        $(".music").click(function () {
            if(msFlag){
                bgMusic.pause();
                $(this).removeClass('rotateFun');
                msFlag=false;
            }else{
                bgMusic.play();
                $(this).addClass('rotateFun');
                msFlag=true;
            }
        });
        //安卓手机预加载
        if(isAndroid){
            let mainfest = [
                // 音频
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/daojishi.mp3",id:'loop1'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/bg.mp3",id:'loop2'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/dianji.mp3",id:'loop3'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/error.mp3",id:'loop4'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/right.mp3",id:'loop5'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/hb1.mp3",id:'loop6'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/hb2.mp3",id:'loop7'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/hb3.mp3",id:'loop8'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/hb4.mp3",id:'loop9'},
                { src: "/WinsMS/application/webapi/view/double_eleven/images/loading1.gif" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/music.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/h_bg.jpg" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/h_text.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/h_mask.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/h_btn1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/h_btn2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/close.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/text.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/pic.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/start.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q_pic1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q_pic2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q_bg.jpg" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/mask_bg.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/btn.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/btn3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/btn4.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/btn5.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/overtime_text.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/best.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/no_best.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q1_a.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q1_b.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q1_c.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m1_text1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m1_text2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m1_text3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/optimal1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q2_a.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q2_b.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q2_c.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m2_text1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m2_text2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m2_text3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/optimal2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q3_a.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q3_b.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q3_c.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m3_text1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m3_text2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m3_text3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/optimal3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q4.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q4_a.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q4_b.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q4_c.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m4_text1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m4_text2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m4_text3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/optimal4.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q5.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q5_a.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q5_b.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q5_c.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m5_text1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m5_text2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m5_text3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/optimal5.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/lv1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/lv2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/lv3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/lv4.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/4.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/5.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/6.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/7.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/8.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/9.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/10.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/t_bg.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/bg.jpg" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/bg1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/bg2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/l_bg.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/l_bg1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/l_bg2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/l_bg3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/l_bg4.png" },


                // 视频
                // { src: "./video/video_01.mp4",id:'myVideo' }

            ];
            let preload = {
                // 预加载函数
                startPreload: function () {
                    let preload = new createjs.LoadQueue(true);
                    //为preloaded添加整个队列变化时展示的进度事件
                    preload.addEventListener("progress", this.handleFileProgress);
                    //注意加载音频文件需要调用如下代码行
                    preload.installPlugin(createjs.SOUND);
                    //为preloaded添加当队列完成全部加载后触发事件
                    preload.addEventListener("complete", this.loadComplete);
                    //设置最大并发连接数  最大值为10
                    preload.setMaxConnections(1);
                    preload.loadManifest(mainfest);
                },
                // 当整个队列变化时展示的进度事件的处理函数
                handleFileProgress: function (event) {
                    $(".percent").text('请耐心等待...' + Math.ceil(event.loaded * 100) + "%");
                },
                // 处理preload添加当队列完成全部加载后触发事件
                loadComplete: function () {
                    // alert('安卓手机加载完成');
                    $(".loading").hide();
                    bgMusic.play();//背景音效
                    //  shuangjie.$pageLoad.addClass('hide').next().removeClass('hide')
                }
            };

            preload.startPreload();
        }
        if (isiOS) {
            document.body.addEventListener('focusin', () => {
                //软键盘弹出的事件处理
                isReset = false;
            });
            document.body.addEventListener('focusout', () => {
                //软键盘收起的事件处理
                isReset = true;
                setTimeout(() => {
                    //当焦点在弹出层的输入框之间切换时先不归位
                    if (isReset) {
                        window.scroll(0, 0);//失焦后强制让页面归位
                    }
                }, 300);
            });

        }

    });
    let url=encodeURI(window.location.href.split('#')[0]);
    $.ajax({
        url:'/WinsMS/getjssdkdata',
        type:'get',
        data:{
            web_auth_wechat_account_id:3,
            this_view_url:url,
        },
        dataType:'json',
        success:function (data) {
            console.log(data);
            wx.config({
                debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                appId: data.appId, // 必填，公众号的唯一标识
                timestamp:data.timestamp, // 必填，生成签名的时间戳
                nonceStr:data.nonceStr, // 必填，生成签名的随机串
                signature:data.signature,// 必填，签名，见附录1
                jsApiList: [
                    'checkJsApi',
                    'onMenuShareTimeline',
                    'onMenuShareAppMessage',
                    'closeWindow',
                    'hideAllNonBaseMenuItem',
                    'chooseWXPay'
                ] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
            });
        }
    });

    wx.ready(function () {
        //分享朋友圈
        //手机终端判断
        let u = navigator.userAgent;
        let isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
        let daoJiShi=document.getElementById('daoJiShi');//倒计时音效
        let bgMusic=document.getElementById('bg');//倒计时音效
        let clickMusic=document.getElementById('click');//点击音效
        let errorMusic=document.getElementById('error');//很遗憾音效
        let rightMusic=document.getElementById('right');//恭喜您音效
        let hb1Music=document.getElementById('hb1');//海报等级一音效
        let hb2Music=document.getElementById('hb2');//海报等级一音效
        let hb3Music=document.getElementById('hb3');//海报等级一音效
        let hb4Music=document.getElementById('hb4');//海报等级一音效
        //音效加载
        bgMusic.load();//背景音效
        daoJiShi.load();//倒计时音效
        clickMusic.load();//点击音效
        errorMusic.load();//很遗憾音效
        rightMusic.load();//恭喜您音效
        hb1Music.load();//海报等级一音效
        hb2Music.load();//海报等级二音效
        hb3Music.load();//海报等级三音效
        hb4Music.load();//海报等级四音效
        //苹果手机预加载
        if(isiOS){
            let mainfest = [
                // 音频
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/daojishi.mp3",id:'loop1'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/bg.mp3",id:'loop2'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/dianji.mp3",id:'loop3'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/error.mp3",id:'loop4'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/right.mp3",id:'loop5'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/hb1.mp3",id:'loop6'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/hb2.mp3",id:'loop7'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/hb3.mp3",id:'loop8'},
                { src: "https://www.win-east.cn/WinsMS/application/webapi/view/double_eleven/music/hb4.mp3",id:'loop9'},
                { src: "/WinsMS/application/webapi/view/double_eleven/images/loading1.gif" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/music.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/h_bg.jpg" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/h_text.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/h_mask.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/h_btn1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/h_btn2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/close.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/text.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/pic.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/start.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q_pic1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q_pic2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q_bg.jpg" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/mask_bg.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/btn.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/btn3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/btn4.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/btn5.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/overtime_text.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/best.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/no_best.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q1_a.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q1_b.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q1_c.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m1_text1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m1_text2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m1_text3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/optimal1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q2_a.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q2_b.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q2_c.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m2_text1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m2_text2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m2_text3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/optimal2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q3_a.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q3_b.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q3_c.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m3_text1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m3_text2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m3_text3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/optimal3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q4.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q4_a.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q4_b.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q4_c.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m4_text1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m4_text2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m4_text3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/optimal4.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q5.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q5_a.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q5_b.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/q5_c.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m5_text1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m5_text2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/m5_text3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/optimal5.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/lv1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/lv2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/lv3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/lv4.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/4.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/5.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/6.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/7.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/8.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/9.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/10.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/t_bg.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/bg.jpg" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/bg1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/bg2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/l_bg.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/l_bg1.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/l_bg2.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/l_bg3.png" },
                { src: "/WinsMS/application/webapi/view/double_eleven/images/l_bg4.png" },


                // 视频
                // { src: "./video/video_01.mp4",id:'myVideo' }

            ];
            let preload = {
                // 预加载函数
                startPreload: function () {
                    let preload = new createjs.LoadQueue(true);
                    //为preloaded添加整个队列变化时展示的进度事件
                    preload.addEventListener("progress", this.handleFileProgress);
                    //注意加载音频文件需要调用如下代码行
                    preload.installPlugin(createjs.SOUND);
                    //为preloaded添加当队列完成全部加载后触发事件
                    preload.addEventListener("complete", this.loadComplete);
                    //设置最大并发连接数  最大值为10
                    preload.setMaxConnections(1);
                    preload.loadManifest(mainfest);
                },
                // 当整个队列变化时展示的进度事件的处理函数
                handleFileProgress: function (event) {
                    $(".percent").text('请耐心等待...' + Math.ceil(event.loaded * 100) + "%");
                },
                // 处理preload添加当队列完成全部加载后触发事件
                loadComplete: function () {
                    //  alert('苹果手机加载完成');
                    $(".loading").hide();
                    bgMusic.play();

                }
            };

            preload.startPreload();
        }

        wx.onMenuShareTimeline({
            title: '双十一避坑摸底考试', // 分享标题
            link: "https://www.win-east.cn/WinsMS/doubleeleven", // 分享链接,将当前登录用户转为puid,以便于发展下线
            imgUrl: 'https://www.win-east.cn/WinsMS/application/webapi/view/mid_autumn_lucky_draw/images/share.png', // 分享图标
            success: function () {
                // 用户确认分享后执行的回调函数
                // alert('分享成功');
                let formData = new FormData();
                let openid=localStorage.getItem('openid');
                let actId=localStorage.getItem('actid');
                formData.append('openid', openid);
                formData.append('actid', actId);
                $.ajax({
                    url: 'https://www.win-east.cn/WinsMS/sharelog',
                    type: 'POST',
                    data: formData,
                    contentType: false,
                    processData: false,
                    dataType: 'json',
                    async: false,
                    success: function (res) {
                        console.log(res);
                    }
                })
            },
            cancel: function () {
                // 用户取消分享后执行的回调函数
            }
        });
        //分享朋友
        wx.onMenuShareAppMessage({
            title: '双十一避坑摸底考试', // 分享标题
            desc: '从此刻开始你将踏入一段剁手不停的双十一旅程你会遇见各种选择买 or 不买，只要跟随你的内心就能到达终点', // 分享描述
            link: '', // 分享链接
            imgUrl: 'https://www.win-east.cn/WinsMS/application/webapi/view/mid_autumn_lucky_draw/images/share.png', // 分享图标
            success: function () {
                // 用户确认分享后执行的回调函数
                // alert('分享成功')
                let formData = new FormData();
                let openid=localStorage.getItem('openid');
                let actId=localStorage.getItem('actid');
                formData.append('openid', openid);
                formData.append('actid', actId);
                console.log(openid);
                $.ajax({
                    url: '/WinsMS/sharelog',
                    type: 'POST',
                    data: formData,
                    contentType: false,
                    processData: false,
                    dataType: 'json',
                    async: false,
                    success: function (res) {
                        console.log(res);
                    }
                })
            },
            cancel: function () {
                //alert('分享取消')
                // 用户取消分享后执行的回调函数
            }
        });
        wx.error(function(res){
            alert(JSON.stringify(res))
            console.log(JSON.stringify(res))
            // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。
            alert("errorMSG:"+res);
        });

    });
    let vm=new Vue({
        el:'#app',
        data:{
            appId:"{$appId}",
            timestamp:"{$timestamp}",
            nonceStr:"{$nonceStr}",
            signature:"{$signature}",
            openid:"{$openid}",
            nickname:"{$nickname}",
            headImgUrl:"{$headimgurl}",
            actId:"{$actid}",
            homeFlag:true,//首页
            page1Flag:false,//第一页
            anClass1:false,
            anClass2:false,
            infoFlag:false,
            oName:'',//姓名
            questionBox:false,//答题页
            question1:true,//第一题
            question2:true,//第二题
            question3:true,//第三题
            question4:true,//第四题
            question5:true,//第五题
            quesFlag1:false,//第一题消失动画
            quesFlag2:false,//第一题消失动画
            quesFlag3:false,//第一题消失动画
            quesFlag4:false,//第一题消失动画
            quesFlag5:false,//第五题消失动画
            maskFlag1:false,//答弹窗
            noBestFlag:false,//很遗憾
            bestFlag:false,//恭喜您
            maskFlag2:false,//超时弹窗
            mask2Text:true,//超时弹窗文字说明
            maskFlag3:true,//答题说明弹窗
            mask1Text1:false,//第一题第一个文字
            mask1Text2:false,//第一题第二个文字
            mask1Text3:false,//第一题第三个文字
            mask2Text1:false,//第二题第一个文字
            mask2Text2:false,//第二题第二个文字
            mask2Text3:false,//第二题第三个文字
            mask3Text1:false,//第三题第一个文字
            mask3Text2:false,//第三题第二个文字
            mask3Text3:false,//第三题第三个文字
            mask4Text1:false,//第四题第一个文字
            mask4Text2:false,//第四题第二个文字
            mask4Text3:false,//第四题第三个文字
            mask5Text1:false,//第五题第一个文字
            mask5Text2:false,//第五题第二个文字
            mask5Text3:false,//第五题第三个文字
            totalNum:0,//总分数
            oIndex:0,//当前答的是第几题
            time:10,//倒计时
            alarmClock:false,//闹钟显示隐藏
            timeFlag:false,
            tipsFlag:false,//提示信息弹窗
            maskBtn1:false,//超时弹窗确定按钮
            maskBtn2:true,//超时弹窗查看最优答案
            maskBtn3:true,//超时弹窗继续下一题
            maskBtn4:false,//超时弹窗生成海报
            timer:null,//定时器
            timer2:null,//定时器
            lastFlag:false,//海报
            canvas:document.getElementById('myCanvas'),
            loadingFlag:true,//loading
            musicFlag:true,//音乐图标
            moveFlag:true,
            skipFlag:false,//跳过按钮
            daoJiShi:document.getElementById('daoJiShi'),//倒计时音效
            bgMusic:document.getElementById('bg'),//倒计时音效
            clickMusic:document.getElementById('click'),//点击音效
            errorMusic:document.getElementById('error'),//很遗憾音效
            rightMusic:document.getElementById('right'),//恭喜您音效
            hb1Music:document.getElementById('hb1'),//海报等级一音效
            hb2Music:document.getElementById('hb2'),//海报等级一音效
            hb3Music:document.getElementById('hb3'),//海报等级一音效
            hb4Music:document.getElementById('hb4'),//海报等级一音效
        },
        created:function () {
            let that=this;
            //that.countDown();//倒计时
            //console.log('appId',that.appId)
            //console.log('nickname',that.nickname)
            //console.log('headImgUrl',that.headImgUrl)
            let W=750;
            let H=1334;
            $('#myCanvas').attr({'height':H,'width':W});
            console.log($('#myCanvas'))

            //音效加载
            that.bgMusic.load();//背景音效
            that.daoJiShi.load();//倒计时音效
            that.daoJiShi.currentTime=0;//倒计时默认从第0秒开始
            that.clickMusic.load();//点击音效
            that.errorMusic.load();//很遗憾音效
            that.rightMusic.load();//恭喜您音效
            that.hb1Music.load();//海报等级一音效
            that.hb2Music.load();//海报等级二音效
            that.hb3Music.load();//海报等级三音效
            that.hb4Music.load();//海报等级四音效
            that.bgMusic.play();
            // that.createPoster();//生成海报
        },
        methods:{
            //查看最优答案
            bestAnswer:function () {
                let that=this;
                console.log('查看最优答案')
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.maskBtn1=true;//确定按钮
                that.maskBtn2=false;//查看最优
                that.maskBtn3=false;//继续下一题
                that.bestFlag=true;//恭喜您
                that.noBestFlag=false;//很遗憾
                that.rightMusic.currentTime=0;//音效默认从第0秒开始
                that.rightMusic.play();//恭喜您音效
                if(that.oIndex==0){
                    //第一题的最优答案显示
                    that.mask2Text=false;
                    that.mask1Text2=true;//第一题选项A对应的文字
                }else if(that.oIndex==1){
                    //第二题的最优答案显示
                    that.mask2Text=false;
                    that.mask2Text1=true;//第二题选项A对应的文字
                }else if(that.oIndex==2){
                    //第三题的最优答案显示
                    that.mask2Text=false;
                    that.mask3Text2=true;//第三题选项A对应的文字
                }else if(that.oIndex==3){
                    //第四题的最优答案显示
                    that.mask2Text=false;
                    that.mask4Text1=true;//第四题选项A对应的文字
                }else if(that.oIndex==4){
                    //第五题的最优答案显示
                    that.mask2Text=false;
                    that.maskBtn1=false;
                    that.mask5Text3=true;//第五题选项A对应的文字
                }
            },
            //下一题
            nextQuestion:function () {
                let that=this;
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.maskFlag1=false;
                that.mask1Text1=false;//第一题选项A对应的文字
                that.mask1Text2=false;//第一题选项B对应的文字
                that.mask1Text3=false;//第一题选项C对应的文字
                that.mask2Text1=false;//第一题选项A对应的文字
                that.mask2Text2=false;//第一题选项B对应的文字
                that.mask2Text3=false;//第一题选项C对应的文字
                that.mask3Text1=false;//第一题选项A对应的文字
                that.mask3Text2=false;//第一题选项B对应的文字
                that.mask3Text3=false;//第一题选项C对应的文字
                that.mask4Text1=false;//第一题选项A对应的文字
                that.mask4Text2=false;//第一题选项B对应的文字
                that.mask4Text3=false;//第一题选项C对应的文字
                that.oIndex++;
                that.maskFlag2=false;//超时弹窗隐藏
                that.mask2Text=true;//超时弹窗文字
                that.countDown();//倒计时
                if(that.oIndex==1){
                    console.log('第一题')
                    that.quesFlag1=true;
                }else if(that.oIndex==2){
                    that.quesFlag2=true;
                    console.log('第二题')
                }else if(that.oIndex==3){
                    that.quesFlag3=true;
                    console.log('第三题')
                }else if(that.oIndex==4){
                    that.quesFlag4=true;
                    console.log('第四题')
                }
            },
            //答题说明点击事件
            explainClick:function(){
                let that=this;
                that.maskFlag3=true;
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
            },
            //关闭答题弹窗
            closeMaskClick:function(){
                let that=this;
                that.maskFlag3=false;
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                //that.daoJiShi.play();

            },
            //进入考场
            startClick:function(){
                let that=this;
                that.homeFlag=false;
                that.page1Flag=true;//第一页显示
                that.anClass1=true;
                that.anClass2=true;
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.timer2=setTimeout(function () {
                    that.skipFlag=true;//跳过按钮
                },6000);
            },
            //文字点击直接跳过动画
            textClick:function(){
                let that=this;
                that.anClass2=false;
                that.anClass1=true;
                that.skipFlag=true;//跳过按钮
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
            },
            //跳过
            skipClick:function(){
                let that=this;
                that.anClass2=false;
                that.anClass1=false;
                that.infoFlag=true;//
                that.skipFlag=false;//跳过按钮
                clearTimeout(that.timer2);//关闭定时器
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
            },
            //开始考试
            startExamination:function(){
                let that=this;
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.skipFlag=false;//跳过按钮
                if(that.oName==''){
                    that.tipsFlag=true;
                    setTimeout(function () {
                        that.tipsFlag=false;
                    },1000)
                }else{
                    that.infoFlag=false;//填写姓名页隐藏
                    that.questionBox=true;//问题页显示
                    that.countDown();//倒计时
                }
            },
            //倒计时
            countDown:function(){
                let that=this;
                that.timeFlag=false;
                that.time=10;

                that.timer=setInterval(function () {
                    that.time--;
                    that.timeFlag=true;
                    if(that.time<5){
                        that.alarmClock=true;//10秒的时候闹钟显示
                        that.daoJiShi.play();//倒计时音效
                    }
                    if(that.time<0){
                        that.time=10;
                        that.maskFlag2=true;//超时弹窗
                        that.noBestFlag=true;//很遗憾
                        that.bestFlag=false;//恭喜您
                        setTimeout(function () {
                            that.errorMusic.currentTime=0;//音效默认从第0秒开始
                            that.errorMusic.play();//很遗憾音效
                        },200);
                        if(that.oIndex==4){
                            that.maskBtn1=false;//确定按钮
                            that.maskBtn2=true;//查看最优
                            that.maskBtn3=false;//继续下一题
                            that.maskBtn4=true;//生成海报
                        }else{
                            that.maskBtn1=false;//确定按钮
                            that.maskBtn2=true;//查看最优
                            that.maskBtn3=true;//继续下一题
                            that.maskBtn4=false;//生成海报
                        }

                        clearInterval(that.timer);
                        that.alarmClock=false;//闹钟隐藏
                        return;
                    }
                    console.log(that.time)
                },1000);
            },


            //生成海报
            createPoster:function(){
                let that=this;
                console.log('生成海报')
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.lastFlag=true;
                let W=750;
                let H=1334;
                let cxt=that.canvas.getContext("2d");
                let img=new Image();//背景图片
                img.setAttribute('crossOrigin', 'anonymous');
                img.src="/WinsMS/application/webapi/view/double_eleven/images/l_bg.png";
                let lastImg=new Image();//称号图片
                let numImg=new Image();//分数图片
                lastImg.setAttribute('crossOrigin', 'anonymous');
                numImg.setAttribute('crossOrigin', 'anonymous');
                alert(that.totalNum)
                if(that.totalNum>0&&that.totalNum<=10){
                    lastImg.src="/WinsMS/application/webapi/view/double_eleven/images/l_bg4.png";
                    numImg.src="/WinsMS/application/webapi/view/double_eleven/images/lv3.png";
                    //that.hb1Music.currentTime=0;//音效默认从第0秒开始
                    //that.hb1Music.play();//等级一音效
                }else if(that.totalNum>10&&that.totalNum<=15){
                    lastImg.src="/WinsMS/application/webapi/view/double_eleven/images/l_bg3.png";
                    numImg.src="/WinsMS/application/webapi/view/double_eleven/images/lv2.png";
                    //that.hb2Music.currentTime=0;//音效默认从第0秒开始
                    //that.hb2Music.play();//等级一音效
                }else if(that.totalNum>15&&that.totalNum<=20){
                    lastImg.src="/WinsMS/application/webapi/view/double_eleven/images/l_bg2.png";
                    numImg.src="/WinsMS/application/webapi/view/double_eleven/images/lv1.png";
                    //that.hb3Music.currentTime=0;//音效默认从第0秒开始
                    //that.hb3Music.play();//等级一音效
                }else if(that.totalNum>=20){
                    lastImg.src="/WinsMS/application/webapi/view/double_eleven/images/l_bg1.png";
                    numImg.src="/WinsMS/application/webapi/view/double_eleven/images/lv4.png";
                    //that.hb4Music.currentTime=0;//音效默认从第0秒开始
                    //that.hb4Music.play();//等级一音效
                }
                //alert(that.totalNum);
                //alert(numImg.src);
                img.onload=function(){
                    cxt.drawImage(img,0, 0, W, H);//绘制背景图
                    cxt.font="bold 40px Arial";
                    cxt.fillStyle="#000";
                    cxt.textAlign = 'center';
                    cxt.fillText(that.oName,245,320);//昵称
                    // cxt.font="bold 50px Arial";
                    // cxt.fillStyle="#000";
                    // cxt.textAlign = 'center';
                    // cxt.fillText(that.totalNum,520,320);//昵称
                    cxt.drawImage(numImg,470, 255, 221, 90);//绘制背景图
                    cxt.drawImage(lastImg,0, 252, 720, 797);//绘制背景图
                    $("#photoPic").attr({'height':H,'width':W});
                    $("#photoPic img").attr("src",that.canvas.toDataURL());
                    $("#photoPic").show();
                    $("#photoPic").addClass("animate");
                };

            },
            //第一题A 加3分
            question1A:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+3;//加3分
                that.mask1Text1=true;//选项A对应的文字
                that.mask1Text2=false;//选项B对应的文字
                that.mask1Text3=false;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.oIndex=1;//第一题
                that.bestFlag=false;//恭喜您
                that.noBestFlag=true;//很遗憾
                that.errorMusic.currentTime=0;//音效默认从第0秒开始
                that.errorMusic.play();//很遗憾音效
            },
            //第一题B 加5分
            question1B:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+5;//加5分
                that.mask1Text1=false;//选项A对应的文字
                that.mask1Text2=true;//选项B对应的文字
                that.mask1Text3=false;//选项C对应的文字
                that.oIndex=1;//第一题
                that.maskFlag1=true;//弹窗显示
                that.bestFlag=true;//恭喜您
                that.noBestFlag=false;//很遗憾
                that.rightMusic.currentTime=0;//音效默认从第0秒开始
                that.rightMusic.play();//恭喜您音效
            },
            //第一题C 加1分
            question1C:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+1;//加1分
                that.mask1Text1=false;//选项A对应的文字
                that.mask1Text2=false;//选项B对应的文字
                that.mask1Text3=true;//选项C对应的文字
                that.oIndex=1;//第一题
                that.maskFlag1=true;//弹窗显示
                that.bestFlag=false;//恭喜您
                that.noBestFlag=true;//很遗憾
                that.errorMusic.currentTime=0;//音效默认从第0秒开始
                that.errorMusic.play();//很遗憾音效
            },
            //第二题A 加5分
            question2A:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+5;//加5分
                that.mask2Text1=true;//选项A对应的文字
                that.mask2Text2=false;//选项B对应的文字
                that.mask2Text3=false;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.oIndex=2;//第二题
                that.bestFlag=true;//恭喜您
                that.noBestFlag=false;//很遗憾
                that.rightMusic.currentTime=0;//音效默认从第0秒开始
                that.rightMusic.play();//恭喜您音效
            },
            //第二题B 加3分
            question2B:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+3;//加3分
                that.mask2Text1=false;//选项A对应的文字
                that.mask2Text2=true;//选项B对应的文字
                that.mask2Text3=false;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.oIndex=2;//第二题
                that.bestFlag=false;//恭喜您
                that.noBestFlag=true;//很遗憾
                that.errorMusic.currentTime=0;//音效默认从第0秒开始
                that.errorMusic.play();//很遗憾音效
            },
            //第二题C 加1分
            question2C:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+1;//加1分
                that.mask2Text1=false;//选项A对应的文字
                that.mask2Text2=false;//选项B对应的文字
                that.mask2Text3=true;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.oIndex=2;//第二题
                that.bestFlag=false;//恭喜您
                that.noBestFlag=true;//很遗憾
                that.errorMusic.currentTime=0;//音效默认从第0秒开始
                that.errorMusic.play();//很遗憾音效
            },
            //第三题A 加3分
            question3A:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+3;//加3分
                that.mask3Text1=true;//选项A对应的文字
                that.mask3Text2=false;//选项B对应的文字
                that.mask3Text3=false;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.oIndex=3;//第三题
                that.bestFlag=true;//恭喜您
                that.noBestFlag=false;//很遗憾
                that.rightMusic.currentTime=0;//音效默认从第0秒开始
                that.rightMusic.play();//恭喜您音效
            },
            //第三题B 加5分
            question3B:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+5;//加5分
                that.mask3Text1=false;//选项A对应的文字
                that.mask3Text2=true;//选项B对应的文字
                that.mask3Text3=false;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.oIndex=3;//第三题
                console.log('第三题B')
                that.bestFlag=true;//恭喜您
                that.noBestFlag=false;//很遗憾
                that.rightMusic.currentTime=0;//音效默认从第0秒开始
                that.rightMusic.play();//恭喜您音效
            },
            //第三题C 加1分
            question3C:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+1;//加1分
                that.mask3Text1=false;//选项A对应的文字
                that.mask3Text2=false;//选项B对应的文字
                that.mask3Text3=true;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.oIndex=3;//第三题
                that.bestFlag=false;//恭喜您
                that.noBestFlag=true;//很遗憾
                that.errorMusic.currentTime=0;//音效默认从第0秒开始
                that.errorMusic.play();//很遗憾音效
            },
            //第四题A 加5分
            question4A:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+5;//加5分
                that.mask4Text1=true;//选项A对应的文字
                that.mask4Text2=false;//选项B对应的文字
                that.mask4Text3=false;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.oIndex=4;//第四题
                that.bestFlag=true;//恭喜您
                that.noBestFlag=false;//很遗憾
                that.rightMusic.currentTime=0;//音效默认从第0秒开始
                that.rightMusic.play();//恭喜您音效
            },
            //第四题B 加1分
            question4B:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+1;//加1分
                that.mask4Text1=false;//选项A对应的文字
                that.mask4Text2=true;//选项B对应的文字
                that.mask4Text3=false;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.oIndex=4;//第四题
                console.log('第四题B')
                that.bestFlag=false;//恭喜您
                that.noBestFlag=true;//很遗憾
                that.errorMusic.currentTime=0;//音效默认从第0秒开始
                that.errorMusic.play();//很遗憾音效
            },
            //第四题C 加3分
            question4C:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+3;//加3分
                that.mask4Text1=false;//选项A对应的文字
                that.mask4Text2=false;//选项B对应的文字
                that.mask4Text3=true;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.oIndex=4;//第四题
                that.bestFlag=true;//恭喜您
                that.noBestFlag=false;//很遗憾
                that.rightMusic.currentTime=0;//音效默认从第0秒开始
                that.rightMusic.play();//恭喜您音效
            },
            //第五题A 加1分
            question5A:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+1;//加1分
                that.mask5Text1=true;//选项A对应的文字
                that.mask5Text2=false;//选项B对应的文字
                that.mask5Text3=false;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.quesFlag5=true;//第五题弹窗按钮
                that.oIndex=5;//第五题
                that.bestFlag=false;//恭喜您
                that.noBestFlag=true;//很遗憾
                that.errorMusic.currentTime=0;//音效默认从第0秒开始
                that.errorMusic.play();//很遗憾音效
            },
            //第五题B 加3分
            question5B:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+3;//加3分
                that.mask5Text1=false;//选项A对应的文字
                that.mask5Text2=true;//选项B对应的文字
                that.mask5Text3=false;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.quesFlag5=true;//第五题弹窗按钮
                that.oIndex=5;//第五题
                that.bestFlag=false;//恭喜您
                that.noBestFlag=true;//很遗憾
                that.errorMusic.currentTime=0;//音效默认从第0秒开始
                that.errorMusic.play();//很遗憾音效
            },
            //第五题C 加5分
            question5C:function () {
                let that=this;
                clearInterval(that.timer);
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.alarmClock=false;//闹钟隐藏
                that.daoJiShi.pause();//倒计时音效暂停
                that.totalNum=Number(that.totalNum)+5;//加5分
                that.mask5Text1=false;//选项A对应的文字
                that.mask5Text2=false;//选项B对应的文字
                that.mask5Text3=true;//选项C对应的文字
                that.maskFlag1=true;//弹窗显示
                that.quesFlag5=true;//第五题弹窗按钮
                that.oIndex=5;//第五题
                that.bestFlag=true;//恭喜您
                that.noBestFlag=false;//很遗憾
                that.rightMusic.currentTime=0;//音效默认从第0秒开始
                that.rightMusic.play();//恭喜您音效
            },
            //关闭弹窗
            closeClick:function () {
                let that=this;
                that.clickMusic.currentTime=0;//音效默认从第0秒开始
                that.clickMusic.play();//点击音效
                that.maskFlag1=false;
                that.mask1Text1=false;//第一题选项A对应的文字
                that.mask1Text2=false;//第一题选项B对应的文字
                that.mask1Text3=false;//第一题选项C对应的文字
                that.mask2Text1=false;//第一题选项A对应的文字
                that.mask2Text2=false;//第一题选项B对应的文字
                that.mask2Text3=false;//第一题选项C对应的文字
                that.mask3Text1=false;//第一题选项A对应的文字
                that.mask3Text2=false;//第一题选项B对应的文字
                that.mask3Text3=false;//第一题选项C对应的文字
                that.mask4Text1=false;//第一题选项A对应的文字
                that.mask4Text2=false;//第一题选项B对应的文字
                that.mask4Text3=false;//第一题选项C对应的文字
                that.countDown();//开启倒计时
                if(that.oIndex==1){
                    that.quesFlag1=true;
                }else if(that.oIndex==2){
                    that.quesFlag2=true;
                }else if(that.oIndex==3){
                    that.quesFlag3=true;
                }else if(that.oIndex==4){
                    that.quesFlag4=true;
                }
            },

        },
    })
</script>
</body>
</html>